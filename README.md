All credit goes to [MiddleSkillz](https://github.com/MiddleSkillz), I simply refactored the code.